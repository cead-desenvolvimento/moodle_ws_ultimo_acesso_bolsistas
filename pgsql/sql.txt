DROP TABLE IF EXISTS sistemascead.fi_frequencia_moodle;

CREATE TABLE sistemascead.fi_frequencia_moodle (
    id bigint NOT NULL,
    fi_datafrequencia_id bigint NOT NULL,
    cm_pessoa_id bigint NOT NULL,
    moodle_id VARCHAR(11) NOT NULL,
    ultimo_acesso timestamp with time zone,
    data_consulta timestamp with time zone NOT NULL DEFAULT CURRENT_TIMESTAMP
);

ALTER TABLE sistemascead.fi_frequencia_moodle ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME sistemascead.fi_frequencia_moodle_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);

ALTER TABLE ONLY sistemascead.fi_frequencia_moodle
    ADD CONSTRAINT sistemascead_frequencia_moodle_pkey PRIMARY KEY (id);

ALTER TABLE ONLY sistemascead.fi_frequencia_moodle
    ADD CONSTRAINT sistemascead_frequencia_moodle_fi_datafrequencia_id_fkey FOREIGN KEY (fi_datafrequencia_id) REFERENCES sistemascead.fi_datafrequencia(id);

ALTER TABLE ONLY sistemascead.fi_frequencia_moodle
    ADD CONSTRAINT sistemascead_frequencia_moodle_cm_pessoa_id_fkey FOREIGN KEY (cm_pessoa_id) REFERENCES sistemascead.cm_pessoa(id);

ALTER TABLE sistemascead.fi_frequencia_moodle OWNER TO sistemascead;